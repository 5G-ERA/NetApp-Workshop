# 5G-ERA ML Control Service

[Back to overview](Step-by-step.md)

This document describes the interface of the 5G-ERA ML Control Service interface for communication between robots and provided machine learning services. The robot has to implement this interface to be able to use 5G-ERA ML Services. Parameters for each specific service are provided with a description.


```ros
/ml_control_services/Start
/ml_control_services/Stop
/ml_control_services/StateSet
/ml_control_services/StateGet
/ml_control_services/StateReset
```

## Start Service
The entry point for each robot. Service will generate unique task_id (UUID), create unique data input/results output topics, and return generated identifiers in response.


| PARAM NAME | PARAM TYPE | DESCRIPTION |
| ---------- | ---------- | ----------- |
| REQUEST  |
| data | String (JSON) | JSON-style string. Robot-specific setting for ML service worker |
| RESPONSE | 
| success | Bool | True / False |
| message | String | Error state |
| task_id | String | UUID generated by start service |
| data_topic | String | Data subscriber unique identifier for specific task_id |
| result_topic | String | Result subscriber unique identifier for specific task_id |
| worker_constraints | String | JSON-style string. Worker-specific constraints for robot. (e.g. maximal image resolution) |


## Stop Service

Kill running nodes and topic for specific task_id

| PARAM NAME | PARAM TYPE | DESCRIPTION |
| ---------- | ---------- | ----------- |
| REQUEST   |
| task_id | String | UUID generated by start service |
| RESPONSE | 
| success | Bool | True / False |
| message | String | Error state |


## StateSet Service

Set internal state of ML service worker based on robot requirements (e.g. previously saved state of the same service, the result of another service, etc.)

| PARAM NAME | PARAM TYPE | DESCRIPTION |
| ---------- | ---------- | ----------- |
| REQUEST   |
| task_id | String | UUID generated by start service |
| data_string | String | JSON-style string. The setting of the internal state of the ML service worker. CAUTION: ML service dependent! |
| RESPONSE | 
| success | Bool | True / False |
| message | String | Error state |

## StateGet Service

Get internal state of ML service worker.

| PARAM NAME | PARAM TYPE | DESCRIPTION |
| ---------- | ---------- | ----------- |
| REQUEST   |
| task_id | String | UUID generated by start service |
| RESPONSE | 
| success | Bool | True / False |
| message | String | Error state |
| data_string | String | JSON-style string. The internal state of the ML service worker. CAUTION: ML service dependent! |

## StateReset Service

Reset the internal state of the ML service worker.

| PARAM NAME | PARAM TYPE | DESCRIPTION |
| ---------- | ---------- | ----------- |
| REQUEST   |
| task_id | String | UUID generated by start service |
| RESPONSE | 
| success | Bool | True / False |
| message | String | Error state |
